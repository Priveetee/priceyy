module.exports=[14747,(e,r,t)=>{r.exports=e.x("path",()=>require("path"))},22734,(e,r,t)=>{r.exports=e.x("fs",()=>require("fs"))},46786,(e,r,t)=>{r.exports=e.x("os",()=>require("os"))},1791,(e,r,t)=>{"use strict";var o=Object.create,n=Object.defineProperty,c=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,l=Object.getPrototypeOf,a=Object.prototype.hasOwnProperty,s=(e,r,t,o)=>{if(r&&"object"==typeof r||"function"==typeof r)for(let l of i(r))a.call(e,l)||l===t||n(e,l,{get:()=>r[l],enumerable:!(o=c(r,l))||o.enumerable});return e},f=(e,r,t)=>(t=null!=e?o(l(e)):{},s(!r&&e&&e.__esModule?t:n(t,"default",{value:e,enumerable:!0}),e)),u={};((e,r)=>{for(var t in r)n(e,t,{get:r[t],enumerable:!0})})(u,{findRootDir:()=>h,getUserDataDir:()=>w}),r.exports=s(n({},"__esModule",{value:!0}),u);var d=f(e.r(14747)),p=f(e.r(22734)),O=f(e.r(46786)),y=e.r(84199);function h(){try{let e=process.cwd();for(;e!==d.default.dirname(e);){let r=d.default.join(e,".vercel");if(p.default.existsSync(r))return e;e=d.default.dirname(e)}}catch(e){throw new y.VercelOidcTokenError("Token refresh only supported in node server environments")}throw new y.VercelOidcTokenError("Unable to find root directory")}function w(){if(process.env.XDG_DATA_HOME)return process.env.XDG_DATA_HOME;switch(O.default.platform()){case"darwin":return d.default.join(O.default.homedir(),"Library/Application Support");case"linux":return d.default.join(O.default.homedir(),".local/share");case"win32":if(process.env.LOCALAPPDATA)return process.env.LOCALAPPDATA;return null;default:return null}}},83697,(e,r,t)=>{"use strict";var o=Object.create,n=Object.defineProperty,c=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,l=Object.getPrototypeOf,a=Object.prototype.hasOwnProperty,s=(e,r,t,o)=>{if(r&&"object"==typeof r||"function"==typeof r)for(let l of i(r))a.call(e,l)||l===t||n(e,l,{get:()=>r[l],enumerable:!(o=c(r,l))||o.enumerable});return e},f=(e,r,t)=>(t=null!=e?o(l(e)):{},s(!r&&e&&e.__esModule?t:n(t,"default",{value:e,enumerable:!0}),e)),u={};((e,r)=>{for(var t in r)n(e,t,{get:r[t],enumerable:!0})})(u,{assertVercelOidcTokenResponse:()=>k,findProjectInfo:()=>g,getTokenPayload:()=>T,getVercelCliToken:()=>w,getVercelDataDir:()=>h,getVercelOidcToken:()=>j,isExpired:()=>m,loadToken:()=>v,saveToken:()=>b}),r.exports=s(n({},"__esModule",{value:!0}),u);var d=f(e.r(14747)),p=f(e.r(22734)),O=e.r(84199),y=e.r(1791);function h(){let e=(0,y.getUserDataDir)();return e?d.join(e,"com.vercel.cli"):null}function w(){let e=h();if(!e)return null;let r=d.join(e,"auth.json");if(!p.existsSync(r))return null;let t=p.readFileSync(r,"utf8");return t?JSON.parse(t).token:null}async function j(e,r,t){try{let o=`https://api.vercel.com/v1/projects/${r}/token?source=vercel-oidc-refresh${t?`&teamId=${t}`:""}`,n=await fetch(o,{method:"POST",headers:{Authorization:`Bearer ${e}`}});if(!n.ok)throw new O.VercelOidcTokenError(`Failed to refresh OIDC token: ${n.statusText}`);let c=await n.json();return k(c),c}catch(e){throw new O.VercelOidcTokenError("Failed to refresh OIDC token",e)}}function k(e){if(!e||"object"!=typeof e)throw TypeError("Expected an object");if(!("token"in e)||"string"!=typeof e.token)throw TypeError("Expected a string-valued token property")}function g(){let e=(0,y.findRootDir)();if(!e)throw new O.VercelOidcTokenError("Unable to find root directory");try{let r=d.join(e,".vercel","project.json");if(!p.existsSync(r))throw new O.VercelOidcTokenError("project.json not found");let t=JSON.parse(p.readFileSync(r,"utf8"));if("string"!=typeof t.projectId&&"string"!=typeof t.orgId)throw TypeError("Expected a string-valued projectId property");return{projectId:t.projectId,teamId:t.orgId}}catch(e){throw new O.VercelOidcTokenError("Unable to find project ID",e)}}function b(e,r){try{let t=(0,y.getUserDataDir)();if(!t)throw new O.VercelOidcTokenError("Unable to find user data directory");let o=d.join(t,"com.vercel.token",`${r}.json`),n=JSON.stringify(e);p.mkdirSync(d.dirname(o),{mode:432,recursive:!0}),p.writeFileSync(o,n),p.chmodSync(o,432);return}catch(e){throw new O.VercelOidcTokenError("Failed to save token",e)}}function v(e){try{let r=(0,y.getUserDataDir)();if(!r)return null;let t=d.join(r,"com.vercel.token",`${e}.json`);if(!p.existsSync(t))return null;let o=JSON.parse(p.readFileSync(t,"utf8"));return k(o),o}catch(e){throw new O.VercelOidcTokenError("Failed to load token",e)}}function T(e){let r=e.split(".");if(3!==r.length)throw new O.VercelOidcTokenError("Invalid token");let t=r[1].replace(/-/g,"+").replace(/_/g,"/"),o=t.padEnd(t.length+(4-t.length%4)%4,"=");return JSON.parse(Buffer.from(o,"base64").toString("utf8"))}function m(e){return 1e3*e.exp<Date.now()+9e5}},90391,(e,r,t)=>{"use strict";var o=Object.defineProperty,n=Object.getOwnPropertyDescriptor,c=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,l={};((e,r)=>{for(var t in r)o(e,t,{get:r[t],enumerable:!0})})(l,{refreshToken:()=>f}),r.exports=((e,r,t,l)=>{if(r&&"object"==typeof r||"function"==typeof r)for(let t of c(r))i.call(e,t)||void 0===t||o(e,t,{get:()=>r[t],enumerable:!(l=n(r,t))||l.enumerable});return e})(o({},"__esModule",{value:!0}),l);var a=e.r(84199),s=e.r(83697);async function f(){let{projectId:e,teamId:r}=(0,s.findProjectInfo)(),t=(0,s.loadToken)(e);if(!t||(0,s.isExpired)((0,s.getTokenPayload)(t.token))){let o=(0,s.getVercelCliToken)();if(!o)throw new a.VercelOidcTokenError("Failed to refresh OIDC token: login to vercel cli");if(!e)throw new a.VercelOidcTokenError("Failed to refresh OIDC token: project id not found");if(!(t=await (0,s.getVercelOidcToken)(o,e,r)))throw new a.VercelOidcTokenError("Failed to refresh OIDC token");(0,s.saveToken)(t,e)}process.env.VERCEL_OIDC_TOKEN=t.token}}];

//# sourceMappingURL=%5Broot-of-the-server%5D__0ea05e0c._.js.map